create database e_commerce;
use e_commerce;
create table users( user_id int unsigned not null primary key auto_increment, username varchar(200) not null, password varchar(300) not null, first_name varchar(150) not null, last_name varchar(250) not null, role enum('customer','admin') default 'customer', created_at datetime default current_timestamp, updated_at datetime default current_timestamp on update current_timestamp);
create table category( category_id int unsigned not null primary key auto_increment, category_name varchar(200) not null, created_at datetime default current_timestamp, updated_at datetime default current_timestamp on update current_timestamp);
create table products( product_id int unsigned primary key auto_increment, category_id int unsigned, product_description text, price decimal(20,2) not null, product_quantity int default 0, created_at datetime default current_timestamp, updated_at datetime default current_timestamp on update current_timestamp, foreign key (category_id) references category(category_id));
create table orders( order_id int unsigned not null primary key auto_increment, product_id int unsigned, user_id int unsigned, order_date datetime default current_timestamp, delivered_date date null, status enum ('pending','shipped','delivered','cancelled') default 'pending', total_amount decimal(20,2) not null, foreign key (product_id) references products(product_id), foreign key (user_id) references users(user_id));
create table product_ordered( product_ordered_id int unsigned not null primary key auto_increment, product_id int unsigned, order_id int unsigned, quantity int not null, price decimal(20,2) not null, product_ordered_date datetime default current_timestamp, foreign key (product_id) references products(product_id), foreign key (order_id) references orders(order_id));
create table reviews( reviews_id int unsigned not null primary key auto_increment, product_id int unsigned, user_id int unsigned, rating int check (rating between 1 and 5), comments text, created_at datetime default current_timestamp, foreign key (product_id) references products(product_id), foreign key (user_id) references users(user_id));
create table shopping_cart( shopping_cart_id int unsigned not null primary key auto_increment, product_id int unsigned, user_id int unsigned, created_at datetime default current_timestamp, foreign key (product_id) references products(product_id), foreign key (user_id) references users(user_id));
create table payment( payment_id int unsigned not null primary key auto_increment, order_id int unsigned, user_id int unsigned, payment_method enum ('credit card','paypal','bank transfer') not null, payment_date datetime default current_timestamp, status enum ('pending','completed','failed','refunded') default 'pending', transaction_id varchar(300) not null, created_at datetime default current_timestamp, updated_at datetime default current_timestamp on update current_timestamp, foreign key (order_id) references orders(order_id), foreign key (user_id) references users(user_id));
insert into users (username,users_password,first_name,last_name,role) values ('chisom23','pascal03','Chisom','Pascal','customer');
insert into users (username,users_password,first_name,last_name,role) values ('reina23','baby98','Charity','Reina','customer');
insert into users (username,users_password,first_name,last_name,role) values ('pharmdoris','@doris99','Doris','Amanda','customer');
insert into category (category_name) values ('jewelry');
insert into category (category_name) values ('groceries');
insert into category (category_name) values ('baby products');
insert into products(category_id,product_description,price,product_quantity,product_name) values ((select category_id from category where category_name = 'jewelry') ,'it is a decorative adornments often made from precious metal and gemstones',1000.00,100,'necklace');
insert into products(category_id,product_description,price,product_quantity,product_name) values ((select category_id from category where category_name = 'groceries') ,'they are everyday food items and household products purchased for sustenance and daily living ',1500.00,200,'snacks');
insert into products(category_id,product_description,price,product_quantity,product_name) values ((select category_id from category where category_name = 'baby products') ,'they are essential items designed to care for infants and toddlers',2000.00,300,'diapers');
insert into orders(product_id,user_id,status,total_amount) values((select product_id from products where product_name = 'necklace'),(select user_id from users where first_name ='Chisom'),'pending',2000.00);
insert into orders(product_id,user_id,status,total_amount) values((select product_id from products where product_name = 'snacks'),(select user_id from users where first_name ='Doris'),'pending',3000.00);
insert into orders(product_id,user_id,status,total_amount) values((select product_id from products where product_name = 'diapers'),(select user_id from users where first_name ='Charity'),'pending',2500.00);
insert into product_ordered(product_id,order_id,quantity,price) values((select product_id from products where product_name ='necklace'),(select order_id from orders where total_amount = 2000.00),10,1000.00);
insert into product_ordered(product_id,order_id,quantity,price) values((select product_id from products where product_name ='diapers'),(select order_id from orders where total_amount = 2500.00),05,1500.00);
insert into product_ordered(product_id,order_id,quantity,price) values((select product_id from products where product_name ='snacks'),(select order_id from orders where total_amount = 3000.00),10,1000.00);
insert into reviews(product_id,user_id,rating,comments) values((select product_id from products where product_name ='necklace'),(select user_id from users where username ='pharmdoris'),4,'the necklace arrived on time,well-packaged and ready to use');
insert into reviews(product_id,user_id,rating,comments) values((select product_id from products where product_name ='snacks'),(select user_id from users where username ='chisom23'),5,'i recently purchased a number of snacks,and am pleased with the quality and variety offered');
insert into reviews(product_id,user_id,rating,comments) values((select product_id from products where product_name ='diapers'),(select user_id from users where username ='reina23'),4,'very satisfied with the diaper purchase,they are of high quality and provide excellent absorbency for my child');
insert into shopping_cart(product_id,user_id) values((select product_id from products where product_name ='diapers'),(select user_id from users where username ='chisom23'));
insert into shopping_cart(product_id,user_id) values((select product_id from products where product_name ='snacks'),(select user_id from users where username ='reina23'));
insert into shopping_cart(product_id,user_id) values((select product_id from products where product_name ='necklace'),(select user_id from users where username ='pharmdoris'));
insert into payment(order_id,user_id,payment_method,status,transaction_id) values((select order_id from orders where total_amount=2000.00),(select user_id from users where username='pharmdoris'),'bank transfer','pending',2206);
insert into payment(order_id,user_id,payment_method,status,transaction_id) values((select order_id from orders where total_amount=2500.00),(select user_id from users where username='chisom23'),'credit card','pending',4409);
insert into payment(order_id,user_id,payment_method,status,transaction_id) values((select order_id from orders where total_amount=3000.00),(select user_id from users where username='reina23'),'credit card','pending',9980);
